<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Auditorio P. Ibiza – Selección de evento</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
<header>
  <span>Auditorio P. Ibiza</span>
  <nav>
    <a href="/" class="header">Inicio</a>
    <a href="/admin" class="header">Administración</a>
    <a href="/validar" class="header">Validar entradas</a>
  </nav>
</header>
  <h1>Bienvenido al Auditorio P. Ibiza</h1>
  <h2>Seleccione un evento para comprar entradas</h2>
  <div id="eventos"></div>

  <script>
    async function cargarEventos() {
      const res = await fetch("/api/eventos");
      const eventos = await res.json();
      const contenedor = document.getElementById("eventos");
      contenedor.innerHTML = "";

      eventos.filter(ev => ev.activo).forEach(ev => {
        const div = document.createElement("div");
        div.className = "evento";

        const img = document.createElement("img");
        img.src = `/static/eventos/${ev.id}.jpg`;
        img.onerror = () => img.style.display = "none";
        img.style.width = "200px";
        img.style.height = "200px";
        img.style.objectFit = "cover";
        img.style.borderRadius = "8px";
        div.appendChild(img);

        const nombre = document.createElement("h3");
        nombre.textContent = ev.nombre;
        div.appendChild(nombre);

        const fecha = document.createElement("p");
        fecha.textContent = `Fecha: ${ev.fecha}`;
        div.appendChild(fecha);

        const btn = document.createElement("button");
        btn.textContent = "Ver asientos disponibles";
        btn.onclick = () => window.location.href = `/evento/${ev.id}`;
        div.appendChild(btn);

        contenedor.appendChild(div);
      });
    }
    document.addEventListener("DOMContentLoaded", cargarEventos);
  </script>
</body>
</html>